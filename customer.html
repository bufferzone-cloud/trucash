<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>TruCash | Customer Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Signature Pad -->
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-storage-compat.js"></script>
    <!-- Cloudinary SDK -->
    <script src="https://upload-widget.cloudinary.com/global/all.js" type="text/javascript"></script>
    <style>
        /* ===== iOS Optimized CSS Reset ===== */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        :root {
            --ios-white: #ffffff;
            --ios-gray-1: #f2f2f7;
            --ios-gray-2: #e5e5ea;
            --ios-gray-3: #d1d1d6;
            --ios-gray-4: #c7c7cc;
            --ios-gray-5: #8e8e93;
            --ios-gray-6: #48484a;
            --ios-blue: #007aff;
            --ios-green: #34c759;
            --ios-green-dark: #248a3d;
            --ios-red: #ff3b30;
            --ios-orange: #ff9500;
            --ios-card-shadow: 0px 1px 3px rgba(0,0,0,0.1), 0px 1px 2px rgba(0,0,0,0.06);
            --ios-card-shadow-hover: 0px 4px 12px rgba(0,0,0,0.1), 0px 2px 4px rgba(0,0,0,0.06);
            --ios-border-radius: 14px;
            --ios-border-radius-small: 10px;
            --ios-border-radius-large: 20px;
            --ios-transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            --ios-safe-area-inset-bottom: env(safe-area-inset-bottom, 20px);
        }

        body {
            background: linear-gradient(135deg, #ffffff 0%, #f9f9f9 100%);
            color: var(--ios-gray-6);
            min-height: 100vh;
            line-height: 1.5;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', 'Helvetica Neue', sans-serif;
            overscroll-behavior-y: none;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: radial-gradient(circle at 10% 20%, rgba(52,199,89,0.02) 0px, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        /* Main Layout */
        .dashboard-container { display: flex; min-height: 100vh; }
        .mobile-header { display: none; position: sticky; top: 0; z-index: 100; background: rgba(255,255,255,0.92); backdrop-filter: blur(20px); padding: 12px 16px; border-bottom: 1px solid var(--ios-gray-2); align-items: center; justify-content: space-between; }
        @media (max-width: 768px) { .mobile-header { display: flex; } }
        .hamburger-menu { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; border-radius: 10px; background: var(--ios-gray-1); border: none; font-size: 18px; cursor: pointer; }
        .mobile-logo { font-size: 18px; font-weight: 700; color: var(--ios-green); display: flex; align-items: center; gap: 8px; }
        .main-content { flex: 1; padding: 16px; max-width: 1200px; margin: 0 auto; width: 100%; padding-bottom: 80px; }
        @media (min-width: 768px) { .main-content { padding: 24px; padding-bottom: 24px; } }

        /* Sidebar */
        .sidebar { position: fixed; left: -280px; top: 0; width: 280px; height: 100vh; background: rgba(255,255,255,0.95); backdrop-filter: blur(30px); border-right: 1px solid rgba(0,0,0,0.1); padding: 20px 16px; z-index: 1000; transition: var(--ios-transition); overflow-y: auto; }
        .sidebar.active { left: 0; }
        @media (min-width: 992px) { .dashboard-container { flex-direction: row; } .sidebar { position: sticky; left: 0; width: 280px; min-height: 100vh; } }
        .logo-container { display: flex; align-items: center; gap: 12px; margin-bottom: 24px; padding-bottom: 16px; border-bottom: 1px solid var(--ios-gray-2); }
        .logo-icon { width: 32px; height: 32px; background: linear-gradient(135deg, var(--ios-green), var(--ios-green-dark)); border-radius: 8px; display: flex; align-items: center; justify-content: center; color: white; }
        .logo-text { font-size: 18px; font-weight: 700; color: var(--ios-green); }
        .nav-menu { display: flex; flex-direction: column; gap: 6px; margin-bottom: 20px; }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 10px 14px; border-radius: var(--ios-border-radius-small); color: var(--ios-gray-6); text-decoration: none; transition: var(--ios-transition); cursor: pointer; }
        .nav-item:hover { background: var(--ios-gray-1); color: var(--ios-green); }
        .nav-item.active { background: var(--ios-green); color: white; box-shadow: 0 2px 8px rgba(52,199,89,0.25); }
        .nav-item i { width: 18px; }
        .notification-badge { position: absolute; right: 14px; top: 50%; transform: translateY(-50%); background: var(--ios-red); color: white; font-size: 10px; padding: 2px 6px; border-radius: 10px; min-width: 18px; text-align: center; }
        .user-profile { margin-top: auto; padding-top: 16px; border-top: 1px solid var(--ios-gray-2); }
        .profile-card { display: flex; align-items: center; gap: 12px; padding: 12px; background: var(--ios-gray-1); border-radius: var(--ios-border-radius-small); border: 1px solid var(--ios-gray-2); }
        .profile-avatar { width: 36px; height: 36px; border-radius: 50%; object-fit: cover; border: 2px solid var(--ios-green); background: white; }
        .profile-info { flex: 1; min-width: 0; }
        .profile-name { font-size: 13px; font-weight: 600; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
        .profile-role { font-size: 11px; color: var(--ios-green); font-weight: 500; }

        /* Header */
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 16px; border-bottom: 1px solid var(--ios-gray-2); }
        .header-title { font-size: 20px; font-weight: 700; letter-spacing: -0.3px; }
        .status-badge { padding: 5px 10px; background: var(--ios-green); color: white; border-radius: 20px; font-size: 11px; display: flex; align-items: center; gap: 5px; }
        .logout-btn { padding: 6px 12px; background: transparent; color: var(--ios-red); border: 1px solid var(--ios-gray-3); border-radius: var(--ios-border-radius-small); font-size: 12px; cursor: pointer; transition: var(--ios-transition); }
        .logout-btn:hover { background: var(--ios-red); color: white; border-color: var(--ios-red); }

        /* Dashboard Cards */
        .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px,1fr)); gap: 12px; margin-bottom: 24px; }
        .dashboard-card { background: var(--ios-white); border-radius: var(--ios-border-radius); padding: 16px; box-shadow: var(--ios-card-shadow); border: 1px solid var(--ios-gray-2); transition: var(--ios-transition); }
        .dashboard-card:hover { box-shadow: var(--ios-card-shadow-hover); transform: translateY(-2px); }
        .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .card-title { font-size: 13px; font-weight: 600; color: var(--ios-gray-6); }
        .card-value { font-size: 22px; font-weight: 700; color: var(--ios-green); margin-bottom: 4px; }
        .card-subtitle { font-size: 12px; color: var(--ios-gray-5); margin-bottom: 8px; }
        .card-footer { font-size: 11px; color: var(--ios-gray-4); }

        /* Sections & Forms */
        .section { background: var(--ios-white); border-radius: var(--ios-border-radius); padding: 18px; margin-bottom: 16px; box-shadow: var(--ios-card-shadow); border: 1px solid var(--ios-gray-2); }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 16px; padding-bottom: 12px; border-bottom: 1px solid var(--ios-gray-2); }
        .section-title { font-size: 16px; font-weight: 600; color: var(--ios-gray-6); }
        .form-group { margin-bottom: 16px; }
        .form-label { display: block; font-size: 12px; font-weight: 600; margin-bottom: 6px; letter-spacing: 0.3px; }
        .form-input { width: 100%; padding: 10px 12px; font-size: 14px; border: 1px solid var(--ios-gray-3); border-radius: var(--ios-border-radius-small); background: var(--ios-white); transition: var(--ios-transition); }
        .form-input:focus { outline: none; border-color: var(--ios-green); box-shadow: 0 0 0 3px rgba(52,199,89,0.1); }
        .form-row { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px,1fr)); gap: 12px; margin-bottom: 12px; }
        .btn { padding: 10px 18px; border-radius: var(--ios-border-radius-small); font-weight: 600; cursor: pointer; border: none; display: inline-flex; align-items: center; gap: 8px; justify-content: center; transition: var(--ios-transition); }
        .btn-primary { background: var(--ios-green); color: white; }
        .btn-primary:hover { background: var(--ios-green-dark); transform: translateY(-1px); box-shadow: 0 4px 12px rgba(52,199,89,0.25); }
        .btn-outline { background: transparent; border: 1px solid var(--ios-gray-3); color: var(--ios-gray-6); }
        .btn-outline:hover { background: var(--ios-gray-1); border-color: var(--ios-gray-4); transform: translateY(-1px); }
        .btn-small { padding: 6px 12px; font-size: 12px; }

        /* Collateral Upload */
        .collateral-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(100px,1fr)); gap: 10px; margin-bottom: 16px; }
        .upload-box { aspect-ratio: 1; border: 2px dashed var(--ios-gray-3); border-radius: var(--ios-border-radius-small); background: var(--ios-white); display: flex; flex-direction: column; align-items: center; justify-content: center; cursor: pointer; position: relative; overflow: hidden; transition: var(--ios-transition); }
        .upload-box:hover { border-color: var(--ios-green); background: rgba(52,199,89,0.05); }
        .upload-box i { font-size: 20px; color: var(--ios-gray-4); margin-bottom: 6px; }
        .upload-box span { font-size: 11px; color: var(--ios-gray-5); text-align: center; padding: 0 4px; }
        .upload-preview { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; border-radius: var(--ios-border-radius-small); }

        /* Mobile Bottom Navigation */
        .mobile-bottom-nav { display: none; position: fixed; bottom: 0; left: 0; width: 100%; background: rgba(255,255,255,0.98); backdrop-filter: blur(20px); border-top: 1px solid var(--ios-gray-2); padding: 10px 16px; z-index: 100; padding-bottom: calc(10px + var(--ios-safe-area-inset-bottom)); }
        @media (max-width: 768px) { .mobile-bottom-nav { display: flex; justify-content: space-around; } }
        .mobile-nav-item { display: flex; flex-direction: column; align-items: center; gap: 4px; color: var(--ios-gray-5); text-decoration: none; font-size: 10px; padding: 6px; border-radius: 8px; min-width: 60px; transition: var(--ios-transition); }
        .mobile-nav-item.active { color: var(--ios-green); background: rgba(52,199,89,0.1); }
        .mobile-nav-item i { font-size: 18px; }

        /* Modals */
        .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.4); backdrop-filter: blur(8px); z-index: 2000; justify-content: center; align-items: center; padding: 16px; opacity: 0; transition: opacity 0.3s ease; }
        .modal.active { display: flex; opacity: 1; }
        .modal-content { background: var(--ios-white); border-radius: var(--ios-border-radius-large); width: 100%; max-width: 700px; max-height: 90vh; overflow-y: auto; box-shadow: var(--ios-card-shadow-hover); animation: modalSlideIn 0.3s ease; }
        @keyframes modalSlideIn { from { opacity: 0; transform: translateY(30px); } to { opacity: 1; transform: translateY(0); } }
        .modal-header { padding: 16px 20px; border-bottom: 1px solid var(--ios-gray-2); display: flex; justify-content: space-between; align-items: center; position: sticky; top: 0; background: white; z-index: 10; }
        .modal-title { font-size: 18px; font-weight: 600; }
        .modal-close { background: var(--ios-gray-1); border: none; width: 28px; height: 28px; border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; transition: var(--ios-transition); }
        .modal-close:hover { background: var(--ios-gray-2); }
        .modal-body { padding: 20px; }
        .modal-footer { padding: 16px 20px; border-top: 1px solid var(--ios-gray-2); display: flex; justify-content: flex-end; gap: 10px; }

        /* Signature Pad */
        .signature-pad-container { border: 1px solid var(--ios-gray-3); border-radius: var(--ios-border-radius-small); background: white; margin-bottom: 10px; position: relative; }
        .signature-pad { width: 100%; height: 150px; touch-action: none; }
        .signature-actions { display: flex; justify-content: flex-end; gap: 8px; margin: 4px 0; }
        .btn-signature-clear { background: var(--ios-gray-2); border: none; padding: 4px 8px; border-radius: 6px; font-size: 12px; color: var(--ios-gray-6); cursor: pointer; }

        /* Agreement Content */
        .agreement-content { padding: 20px; font-size: 14px; background: white; }
        .agreement-content .line-field { border-bottom: 1px solid #333; display: inline-block; min-width: 180px; padding: 0 4px; font-weight: normal; margin: 0 4px; }
        .agreement-content h3 { margin-top: 20px; margin-bottom: 8px; color: var(--ios-green-dark); font-size: 16px; }
        .agreement-content ul { margin-left: 24px; margin-bottom: 12px; }
        .agreement-content p { margin: 8px 0; }

        /* Certificate Viewer */
        .certificate-container { background: #f4f6f9; padding: 20px; border-radius: var(--ios-border-radius); }
        .pdf-viewer iframe { width: 100%; height: 500px; border: 1px solid var(--ios-gray-3); border-radius: 6px; }

        /* Status badges */
        .status-badge-tag { padding: 4px 8px; border-radius: 12px; font-size: 11px; font-weight: 600; display: inline-block; }
        .status-active { background: #d4edda; color: #155724; }
        .status-pending { background: #fff3cd; color: #856404; }
        .status-rejected { background: #f8d7da; color: #721c24; }
        .status-completed { background: #d1ecf1; color: #0c5460; }
        .d-none { display: none; }
        .text-success { color: var(--ios-green) !important; }
        .text-muted { color: var(--ios-gray-5) !important; }
        .mb-2 { margin-bottom: 8px; }
        .mt-3 { margin-top: 12px; }
        .w-100 { width: 100%; }
        .text-center { text-align: center; }
    </style>
</head>
<body>
    <!-- Loading Overlay -->
    <div class="loading-overlay" id="loadingOverlay" style="display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(255,255,255,0.95); backdrop-filter:blur(10px); justify-content:center; align-items:center; z-index:3000; flex-direction:column; gap:16px;">
        <div class="loading-spinner" style="width:40px; height:40px; border:3px solid var(--ios-gray-2); border-top-color:var(--ios-green); border-radius:50%; animation:spin 1s linear infinite;"></div>
        <div class="loading-text">Loading Dashboard...</div>
    </div>
    @keyframes spin { to { transform: rotate(360deg); } }

    <!-- Toast Container -->
    <div class="toast-container" id="toastContainer" style="position:fixed; top:20px; right:20px; z-index:4000; max-width:350px;"></div>

    <!-- Mobile Header -->
    <div class="mobile-header">
        <button class="hamburger-menu" id="menuToggle"><i class="fas fa-bars"></i></button>
        <div class="mobile-logo"><i class="fas fa-wallet"></i><span>TruCash</span></div>
        <div class="status-badge"><i class="fas fa-circle"></i><span id="connectionStatus">Online</span></div>
    </div>

    <!-- Main Container -->
    <div class="dashboard-container">
        <!-- Sidebar -->
        <aside class="sidebar" id="sidebar">
            <div class="logo-container">
                <div class="logo-icon"><i class="fas fa-wallet"></i></div>
                <div class="logo-text">TruCash</div>
            </div>
            <nav class="nav-menu">
                <a href="#" class="nav-item active" data-section="dashboard"><i class="fas fa-home"></i><span>Dashboard</span></a>
                <a href="#" class="nav-item" data-section="profile"><i class="fas fa-user"></i><span>My Profile</span></a>
                <a href="#" class="nav-item" data-section="apply"><i class="fas fa-file-contract"></i><span>Apply for Loan</span></a>
                <a href="#" class="nav-item" data-section="loans"><i class="fas fa-hand-holding-usd"></i><span>My Loans</span></a>
                <a href="#" class="nav-item" data-section="payments"><i class="fas fa-credit-card"></i><span>Payments</span></a>
                <a href="#" class="nav-item" data-section="notifications"><i class="fas fa-bell"></i><span>Notifications</span><span class="notification-badge" id="notificationCount" style="display:none;">0</span></a>
                <a href="#" class="nav-item" data-section="history"><i class="fas fa-history"></i><span>Loan History</span></a>
                <a href="#" class="nav-item" data-section="about"><i class="fas fa-info-circle"></i><span>About Us</span></a>
                <a href="#" class="nav-item" data-section="settings"><i class="fas fa-cog"></i><span>Settings</span></a>
            </nav>
            <div class="user-profile">
                <div class="profile-card">
                    <img src="" alt="Profile" class="profile-avatar" id="profileAvatar" onerror="this.src='data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><rect width=%22100%22 height=%22100%22 fill=%22%2334c759%22/><text x=%2250%22 y=%2250%22 font-size=%2250%22 text-anchor=%22middle%22 dy=%22.3em%22 fill=%22white%22>U</text></svg>'">
                    <div class="profile-info">
                        <div class="profile-name" id="profileName">Loading...</div>
                        <div class="profile-role">Customer</div>
                    </div>
                    <button class="logout-btn btn-small" id="sidebarLogoutBtn"><i class="fas fa-sign-out-alt"></i></button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <header class="header">
                <div class="header-title" id="pageTitle">Customer Dashboard</div>
                <div class="header-actions">
                    <div class="status-badge"><i class="fas fa-circle"></i><span id="desktopConnectionStatus">Online</span></div>
                    <button class="logout-btn" id="logoutBtn"><i class="fas fa-sign-out-alt"></i> Logout</button>
                </div>
            </header>

            <!-- Content Area -->
            <div id="contentArea">
                <!-- Dashboard Section (will be populated by JS) -->
                <section id="dashboardSection" class="content-section">
                    <div class="dashboard-grid" id="dashboardStats"></div>
                    <div class="section" id="agentValidationSection"></div>
                    <div class="section" id="quickActions"></div>
                </section>

                <!-- Profile Section (simplified but functional) -->
                <section id="profileSection" class="content-section d-none">
                    <div class="section">
                        <div class="section-header"><div class="section-title">My Profile</div><button class="btn btn-outline btn-small" id="editProfileBtn"><i class="fas fa-edit"></i> Edit</button></div>
                        <div class="profile-display" id="profileDisplay"></div>
                    </div>
                </section>

                <!-- Apply for Loan Section (with witness fields) -->
                <section id="applySection" class="content-section d-none">
                    <div class="section">
                        <div class="section-header"><div class="section-title">Apply for New Loan</div><div class="section-subtitle text-success" id="loanLimitInfo"></div></div>
                        <div id="loanApplicationForm">
                            <div class="form-group">
                                <label for="loanAmount" class="form-label">Loan Amount (Kwacha)</label>
                                <input type="number" id="loanAmount" class="form-input" placeholder="Enter amount" min="100" step="100">
                                <div class="form-text text-muted" id="amountValidation"></div>
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="loanDuration" class="form-label">Loan Duration (months)</label>
                                    <select id="loanDuration" class="form-input">
                                        <option value="1">1 Month</option>
                                        <option value="3">3 Months</option>
                                        <option value="6" selected>6 Months</option>
                                        <option value="9">9 Months</option>
                                        <option value="12">12 Months</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="loanPurpose" class="form-label">Loan Purpose</label>
                                    <select id="loanPurpose" class="form-input">
                                        <option value="business">Business Capital</option>
                                        <option value="education">Education</option>
                                        <option value="medical">Medical Expenses</option>
                                        <option value="personal">Personal Use</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="purposeDescription" class="form-label">Purpose Description</label>
                                <textarea id="purposeDescription" class="form-input" rows="2"></textarea>
                            </div>
                            <!-- Collateral section (simplified) -->
                            <div class="section">
                                <div class="section-header"><div class="section-title">Collateral Details</div></div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="collateralCategory" class="form-label">Collateral Type</label>
                                        <select id="collateralCategory" class="form-input">
                                            <option value="property">Property</option><option value="vehicle">Vehicle</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label for="collateralValue" class="form-label">Estimated Value (Kwacha)</label>
                                        <input type="number" id="collateralValue" class="form-input">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="collateralDescription" class="form-label">Collateral Description</label>
                                    <textarea id="collateralDescription" class="form-input" rows="2"></textarea>
                                </div>
                                <div class="form-group">
                                    <label for="collateralLocation" class="form-label">Physical Location</label>
                                    <input type="text" id="collateralLocation" class="form-input">
                                </div>
                                <div class="form-group">
                                    <label class="form-label">Collateral Images (Min 3)</label>
                                    <div class="collateral-grid" id="collateralGrid"></div>
                                    <div id="collateralUploadStatus" class="form-text text-muted">Click boxes to upload</div>
                                    <div id="collateralUrls" class="d-none"></div>
                                </div>
                            </div>
                            <!-- Witness Fields -->
                            <div class="section">
                                <div class="section-header"><div class="section-title">Witness Information</div></div>
                                <div class="form-row">
                                    <div class="form-group">
                                        <label for="witnessName" class="form-label">Witness Full Name</label>
                                        <input type="text" id="witnessName" class="form-input" placeholder="Full name">
                                    </div>
                                    <div class="form-group">
                                        <label for="witnessNRC" class="form-label">Witness NRC</label>
                                        <input type="text" id="witnessNRC" class="form-input" placeholder="123456/78/9">
                                    </div>
                                </div>
                                <div class="form-group">
                                    <label for="witnessPhone" class="form-label">Witness Phone (optional)</label>
                                    <input type="tel" id="witnessPhone" class="form-input">
                                </div>
                            </div>
                            <div class="form-group">
                                <div class="terms-box p-3 border rounded" style="background:var(--ios-gray-1);">
                                    <p>By submitting, you agree to the loan terms: <strong>35% monthly interest</strong> and collateral seizure upon default.</p>
                                    <div class="form-check"><input type="checkbox" class="form-check-input" id="acceptTerms"> <label for="acceptTerms">I accept</label></div>
                                </div>
                            </div>
                            <div class="d-flex gap-2 mt-4">
                                <button class="btn btn-outline flex-grow-1" id="cancelLoanBtn">Cancel</button>
                                <button class="btn btn-primary flex-grow-1" id="submitLoanBtn" disabled>Submit Application</button>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Loans Section with filter -->
                <section id="loansSection" class="content-section d-none">
                    <div class="section">
                        <div class="section-header">
                            <div class="section-title">All Loans</div>
                            <select id="loanFilterStatus" class="form-input" style="width:auto;">
                                <option value="all">All</option>
                                <option value="pending">Pending</option>
                                <option value="approved">Approved</option>
                                <option value="active">Active</option>
                                <option value="rejected">Rejected</option>
                                <option value="completed">Completed</option>
                            </select>
                        </div>
                        <div id="allLoansList"></div>
                    </div>
                    <div class="section">
                        <div class="section-header"><div class="section-title">Loan Details</div></div>
                        <div id="loanDetails" class="p-3"></div>
                    </div>
                </section>

                <!-- Payments Section (with loan selector) -->
                <section id="paymentsSection" class="content-section d-none">
                    <div class="section">
                        <div class="section-header"><div class="section-title">Make Payment</div></div>
                        <div id="paymentFormContainer"></div>
                    </div>
                    <div class="section">
                        <div class="section-header"><div class="section-title">Payment History</div></div>
                        <div id="paymentHistory"></div>
                    </div>
                </section>

                <!-- Notifications Section (placeholder) -->
                <section id="notificationsSection" class="content-section d-none"><div class="section">...</div></section>
                <!-- Loan History Section (placeholder) -->
                <section id="historySection" class="content-section d-none"><div class="section">...</div></section>
                <!-- About Us Section -->
                <section id="aboutSection" class="content-section d-none">
                    <div class="section">
                        <div class="section-header"><div class="section-title">About TruCash</div></div>
                        <p>TruCash is a licensed micro-lender in Zambia, providing quick and transparent loans since 2018.</p>
                        <button class="btn btn-primary mt-3" id="showVerifiedDocBtn"><i class="fas fa-file-pdf"></i> Our Verified Docx</button>
                    </div>
                </section>
                <!-- Settings Section (placeholder) -->
                <section id="settingsSection" class="content-section d-none"><div class="section">...</div></section>
            </div>
        </main>
    </div>

    <!-- Mobile Bottom Navigation -->
    <nav class="mobile-bottom-nav">
        <a href="#" class="mobile-nav-item active" data-section="dashboard"><i class="fas fa-home"></i><span>Home</span></a>
        <a href="#" class="mobile-nav-item" data-section="apply"><i class="fas fa-file-contract"></i><span>Apply</span></a>
        <a href="#" class="mobile-nav-item" data-section="loans"><i class="fas fa-hand-holding-usd"></i><span>Loans</span></a>
        <a href="#" class="mobile-nav-item" data-section="payments"><i class="fas fa-credit-card"></i><span>Pay</span></a>
        <a href="#" class="mobile-nav-item" data-section="about"><i class="fas fa-info-circle"></i><span>About</span></a>
    </nav>

    <!-- Loan Agreement Modal -->
    <div class="modal" id="loanAgreementModal">
        <div class="modal-content" style="max-width:700px;">
            <div class="modal-header">
                <h3 class="modal-title">Loan Agreement</h3>
                <button class="modal-close" id="closeAgreementModal">&times;</button>
            </div>
            <div class="modal-body agreement-content" id="agreementContent"></div>
            <div class="modal-footer">
                <button class="btn btn-outline" id="cancelAgreementBtn">Cancel</button>
                <button class="btn btn-primary" id="signAndSubmitAgreementBtn">Sign & Submit Agreement</button>
            </div>
        </div>
    </div>

    <!-- Verified Document Modal (TPIN Certificate) -->
    <div class="modal" id="verifiedDocModal">
        <div class="modal-content" style="max-width:800px;">
            <div class="modal-header">
                <h3 class="modal-title">Tax Registration Certificate</h3>
                <button class="modal-close" id="closeDocModal">&times;</button>
            </div>
            <div class="modal-body certificate-container">
                <h1 style="text-align:center; color:#003366;">Tax Registration Certificate</h1>
                <p>This is to certify that the taxpayer shown herein has been registered with Zambia Revenue Authority.</p>
                <div class="section-title" style="background:#003366; color:white; padding:8px; border-radius:4px;">Section A - Taxpayer Information</div>
                <div class="detail"><span class="label">Taxpayer Identification Number:</span> 1016635011</div>
                <div class="detail"><span class="label">Taxpayer Name:</span> Moses Ilunga</div>
                <div class="detail"><span class="label">Trading Name:</span> Moses Ilunga</div>
                <div class="detail"><span class="label">NRC Number:</span> 307450681</div>
                <div class="detail"><span class="label">Physical Address:</span> 5230, Hillcrest Extension, Richard Mwanza, Ndola, Copperbelt Province, Zambia</div>
                <div class="section-title" style="background:#003366; color:white; padding:8px; border-radius:4px; margin-top:20px;">Section B - Registration Details</div>
                <div class="detail"><span class="label">Type of Registration:</span> Taxpayer Identification Number</div>
                <div class="detail"><span class="label">Effective Date:</span> 17/07/2018</div>
                <div class="detail"><span class="label">Issue Date:</span> 17/07/2018</div>
                <div class="detail"><span class="label">Commissioner – Domestic Taxes:</span> MOSES SHUKO</div>
                <p style="margin-top:20px;">This certificate will remain in force until it is cancelled by ZRA.</p>
                <div class="section-title" style="background:#003366; color:white; padding:8px; border-radius:4px;">Scanned Certificate Copy</div>
                <div class="pdf-viewer"><iframe src="Scan.pdf"></iframe></div>
                <p class="text-muted text-center mt-2">Official document – valid only with signature</p>
            </div>
        </div>
    </div>

    <!-- Edit Profile Modal (simplified) -->
    <div class="modal" id="editProfileModal">...</div>

    <script>
        // ===== Firebase Config (same as original) =====
        const firebaseConfig = {
            apiKey: "AIzaSyCWm9yvg5he7Lncy3h51n7ytOq7AZrA9gs",
            authDomain: "trucash-9fee8.firebaseapp.com",
            databaseURL: "https://trucash-9fee8-default-rtdb.firebaseio.com",
            projectId: "trucash-9fee8",
            storageBucket: "trucash-9fee8.firebasestorage.app",
            messagingSenderId: "622416212225",
            appId: "1:622416212225:web:07418a9b16f955c330ab00"
        };

        // ===== Initialize Firebase =====
        let app, auth, db, storage;
        try {
            app = firebase.initializeApp(firebaseConfig);
            auth = firebase.auth();
            db = firebase.database();
            storage = firebase.storage();
        } catch (e) { console.error(e); }

        // ===== Cloudinary Config =====
        const cloudinaryConfig = {
            cloudName: 'dd3lcymrk',
            uploadPreset: 'h3eyhc2o',
            folder: 'trucash/customers',
            maxFileSize: 10485760,
            allowedFormats: ['jpg','jpeg','png']
        };

        // ===== App State =====
        const AppState = {
            currentUser: null,
            userData: null,
            agentData: null,
            activeLoans: [],
            completedLoans: [],
            payments: [],
            notifications: [],
            uploadedCollateral: {},
            currentSection: 'dashboard',
            systemSettings: { maxLoanAmount:50000, minLoanAmount:100, interestRate:35 } // monthly 35%
        };

        // ===== Utility Functions =====
        const Utils = {
            showLoading(msg='Loading...') { 
                const el = document.getElementById('loadingOverlay');
                el.querySelector('.loading-text').textContent = msg;
                el.style.display = 'flex';
            },
            hideLoading() { document.getElementById('loadingOverlay').style.display = 'none'; },
            showToast(title, msg, type='info') {
                const container = document.getElementById('toastContainer');
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.style.cssText = 'background:white; border-radius:14px; padding:14px 16px; margin-bottom:10px; box-shadow:0 4px 12px rgba(0,0,0,0.15); border-left:4px solid ' + (type==='error'?'#ff3b30':type==='warning'?'#ff9500':'#34c759') + '; display:flex; align-items:flex-start; gap:12px; animation:slideInRight 0.3s ease;';
                toast.innerHTML = `<div class="toast-icon"><i class="fas fa-${type==='error'?'exclamation-circle':type==='warning'?'exclamation-triangle':'info-circle'}"></i></div><div class="toast-content"><div class="toast-title" style="font-weight:600;">${title}</div><div class="toast-message" style="font-size:13px;">${msg}</div></div><button class="toast-close" onclick="this.parentElement.remove()"><i class="fas fa-times"></i></button>`;
                container.appendChild(toast);
                setTimeout(() => { if(toast.parentNode) toast.remove(); }, 5000);
            },
            formatCurrency(amount) { return 'K' + (parseFloat(amount)||0).toFixed(2); },
            formatDate(ts) { return ts ? new Date(Number(ts)).toLocaleDateString() : 'N/A'; }
        };

        // ===== Firebase Service (extended) =====
        const FirebaseService = {
            async checkAuth() {
                return new Promise(resolve => {
                    auth.onAuthStateChanged(async user => {
                        if(!user) { window.location.href = 'login.html'; return; }
                        const snap = await db.ref('users/'+user.uid).once('value');
                        if(!snap.exists()) { auth.signOut(); return; }
                        AppState.currentUser = user;
                        AppState.userData = snap.val();
                        await this.loadSystemSettings();
                        if(AppState.userData.assignedAgentId) await this.loadAgentData(AppState.userData.assignedAgentId);
                        await this.loadLoans();
                        resolve(AppState.userData);
                    });
                });
            },
            async loadSystemSettings() {
                const snap = await db.ref('systemSettings').once('value');
                if(snap.exists()) AppState.systemSettings = snap.val();
            },
            async loadAgentData(agentId) {
                const snap = await db.ref('users/'+agentId).once('value');
                if(snap.exists() && snap.val().userType==='agent') AppState.agentData = snap.val();
            },
            async loadLoans() {
                const snap = await db.ref('loans').orderByChild('customerId').equalTo(AppState.currentUser.uid).once('value');
                const loans = [];
                snap.forEach(c => { let v=c.val(); v.id=c.key; loans.push(v); });
                loans.sort((a,b)=>b.createdAt - a.createdAt);
                AppState.activeLoans = loans.filter(l => ['pending','approved','active'].includes(l.status));
                AppState.completedLoans = loans.filter(l => ['rejected','completed','defaulted'].includes(l.status));
            },
            async submitLoanApplication(loanData, agreementData) {
                try {
                    const loanId = 'LN'+Date.now()+Math.random().toString(36).substr(2,6).toUpperCase();
                    const loanRef = db.ref('loans/'+loanId);
                    const loan = {
                        id: loanId,
                        customerId: AppState.currentUser.uid,
                        customerName: AppState.userData.fullName,
                        amount: loanData.amount,
                        duration: loanData.duration,
                        interestRate: 35,
                        totalInterest: loanData.amount * 0.35 * loanData.duration,
                        totalPayable: loanData.amount + (loanData.amount * 0.35 * loanData.duration),
                        monthlyPayment: loanData.amount * 0.35 + (loanData.amount / loanData.duration), // simplified
                        purpose: loanData.purpose,
                        purposeDescription: loanData.purposeDescription,
                        collateral: { category:loanData.collateralCategory, value:loanData.collateralValue, description:loanData.collateralDescription, location:loanData.collateralLocation, images:Object.values(AppState.uploadedCollateral).map(f=>f.url) },
                        witness: { name:loanData.witnessName, nrc:loanData.witnessNRC, phone:loanData.witnessPhone },
                        status: 'pending',
                        createdAt: Date.now(),
                        updatedAt: Date.now(),
                        agreement: agreementData // signature data URLs stored here
                    };
                    await loanRef.set(loan);
                    // also store agreement separately if needed
                    await db.ref('loanAgreements/'+loanId).set(agreementData);
                    return { success: true, loanId };
                } catch(e) { return { success: false, error: e.message }; }
            }
        };

        // ===== Cloudinary Upload =====
        const CloudinaryService = {
            widget: null,
            init() {
                this.widget = cloudinary.createUploadWidget(cloudinaryConfig, (error, result) => {
                    if(result && result.event === 'success') {
                        const activeBox = document.querySelector('.upload-box.active');
                        if(activeBox) {
                            const url = result.info.secure_url;
                            const preview = document.createElement('img');
                            preview.className = 'upload-preview';
                            preview.src = url;
                            activeBox.appendChild(preview);
                            activeBox.classList.add('has-preview');
                            const type = activeBox.dataset.type || 'collateral';
                            AppState.uploadedCollateral[type] = { url, type };
                            document.getElementById('collateralUploadStatus').textContent = Object.keys(AppState.uploadedCollateral).length + ' images uploaded';
                        }
                    }
                });
            },
            open(box) {
                document.querySelectorAll('.upload-box').forEach(b => b.classList.remove('active'));
                box.classList.add('active');
                this.widget.open();
            }
        };

        // ===== Signature Pad Manager =====
        const SignatureManager = {
            pads: {},
            createPad(containerId, options) {
                const canvas = document.createElement('canvas');
                canvas.className = 'signature-pad';
                containerId.appendChild(canvas);
                const pad = new SignaturePad(canvas, options);
                const clearBtn = document.createElement('button');
                clearBtn.className = 'btn-signature-clear';
                clearBtn.textContent = 'Clear';
                clearBtn.onclick = () => pad.clear();
                containerId.appendChild(clearBtn);
                return pad;
            }
        };

        // ===== UI Manager =====
        const UIManager = {
            async init() {
                await FirebaseService.checkAuth();
                CloudinaryService.init();
                this.bindEvents();
                this.showSection('dashboard');
                this.updateUI();
                Utils.hideLoading();
            },
            bindEvents() {
                document.querySelectorAll('.nav-item, .mobile-nav-item').forEach(el => {
                    el.addEventListener('click', (e) => {
                        e.preventDefault();
                        const section = el.dataset.section;
                        this.showSection(section);
                    });
                });
                document.getElementById('menuToggle').addEventListener('click', () => {
                    document.getElementById('sidebar').classList.toggle('active');
                });
                document.getElementById('logoutBtn').addEventListener('click', () => auth.signOut());
                document.getElementById('sidebarLogoutBtn').addEventListener('click', () => auth.signOut());
                document.getElementById('submitLoanBtn').addEventListener('click', () => this.prepareLoanAgreement());
                document.getElementById('showVerifiedDocBtn').addEventListener('click', () => {
                    document.getElementById('verifiedDocModal').classList.add('active');
                });
                document.querySelectorAll('.modal-close, #closeDocModal, #closeAgreementModal, #cancelAgreementBtn').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.target.closest('.modal').classList.remove('active');
                    });
                });
                document.getElementById('signAndSubmitAgreementBtn').addEventListener('click', () => this.submitLoanWithAgreement());
                // Filter loans
                document.getElementById('loanFilterStatus')?.addEventListener('change', () => this.renderLoans());
            },
            showSection(sectionId) {
                document.querySelectorAll('.content-section').forEach(s => s.classList.add('d-none'));
                const sec = document.getElementById(sectionId + 'Section');
                if(sec) sec.classList.remove('d-none');
                document.querySelectorAll('.nav-item, .mobile-nav-item').forEach(n => n.classList.remove('active'));
                document.querySelector(`.nav-item[data-section="${sectionId}"]`)?.classList.add('active');
                document.querySelector(`.mobile-nav-item[data-section="${sectionId}"]`)?.classList.add('active');
                document.getElementById('pageTitle').textContent = sectionId.charAt(0).toUpperCase() + sectionId.slice(1);
                if(sectionId === 'apply') this.renderApplyForm();
                if(sectionId === 'loans') this.renderLoans();
                if(sectionId === 'payments') this.renderPayments();
                if(sectionId === 'dashboard') this.renderDashboard();
            },
            renderDashboard() {
                const stats = document.getElementById('dashboardStats');
                const active = AppState.activeLoans.filter(l => l.status==='active').length;
                const totalBorrowed = AppState.activeLoans.reduce((s,l)=> s + (l.amount||0),0);
                stats.innerHTML = `
                    <div class="dashboard-card"><div class="card-header">Active Loans</div><div class="card-value">${active}</div></div>
                    <div class="dashboard-card"><div class="card-header">Total Borrowed</div><div class="card-value">${Utils.formatCurrency(totalBorrowed)}</div></div>
                `;
            },
            renderApplyForm() {
                const collateralGrid = document.getElementById('collateralGrid');
                collateralGrid.innerHTML = '';
                for(let i=1; i<=4; i++) {
                    const box = document.createElement('div');
                    box.className = 'upload-box';
                    box.dataset.type = 'collateral-'+i;
                    box.innerHTML = '<i class="fas fa-camera"></i><span>Image '+i+'</span>';
                    box.onclick = () => CloudinaryService.open(box);
                    collateralGrid.appendChild(box);
                }
                document.getElementById('loanAmount').addEventListener('input', this.validateLoanForm.bind(this));
                document.getElementById('acceptTerms').addEventListener('change', this.validateLoanForm.bind(this));
            },
            validateLoanForm() {
                const amount = parseFloat(document.getElementById('loanAmount').value) || 0;
                const terms = document.getElementById('acceptTerms').checked;
                const images = Object.keys(AppState.uploadedCollateral).length >= 3;
                const witnessName = document.getElementById('witnessName')?.value.trim() !== '';
                const witnessNRC = document.getElementById('witnessNRC')?.value.trim() !== '';
                const valid = amount >= 100 && amount <= 50000 && terms && images && witnessName && witnessNRC;
                document.getElementById('submitLoanBtn').disabled = !valid;
                return valid;
            },
            prepareLoanAgreement() {
                if(!this.validateLoanForm()) return;
                // Build agreement HTML
                const amount = document.getElementById('loanAmount').value;
                const duration = document.getElementById('loanDuration').value;
                const purpose = document.getElementById('loanPurpose').value;
                const desc = document.getElementById('purposeDescription').value;
                const collateralDesc = document.getElementById('collateralDescription').value;
                const collateralVal = document.getElementById('collateralValue').value;
                const witnessName = document.getElementById('witnessName').value;
                const witnessNRC = document.getElementById('witnessNRC').value;
                const today = new Date();
                const day = today.getDate();
                const month = today.toLocaleString('default', { month: 'long' });
                const year = today.getFullYear();
                const totalInterest = amount * 0.35 * duration;
                const totalPayable = +amount + totalInterest;
                const agreementHTML = `
                    <h1 style="text-align:center;">TrueCash Money Lender Firm</h1>
                    <h2 style="text-align:center;">Loan Agreement Form</h2>
                    <p>This Loan Agreement is made on this <span class="line-field">${day}</span> day of <span class="line-field">${month}</span>, 20<span class="line-field">${year.toString().slice(2)}</span>.</p>
                    <h3>1. Lender Details</h3>
                    <p>Lending Firm: TrueCash Money Lender</p>
                    <p>Representatives: Eng. Hambayi, Dr. Ilunga, Mr. Mukandawire</p>
                    <h3>2. Borrower Details</h3>
                    <p>Full Name: <span class="line-field">${AppState.userData.fullName || ''}</span></p>
                    <p>NRC Number: <span class="line-field">${AppState.userData.nrc || ''}</span></p>
                    <p>Address: <span class="line-field">${AppState.userData.residence || ''}</span></p>
                    <h3>3. Loan Terms</h3>
                    <p>Loan Amount: ZMW <span class="line-field">${amount}</span></p>
                    <p>Interest Rate: Weekly 10%, Monthly 35%</p>
                    <p>Duration: <span class="line-field">${duration} months</span></p>
                    <p>Total Payable: ZMW <span class="line-field">${totalPayable.toFixed(2)}</span></p>
                    <h3>4. Collateral Details</h3>
                    <p>Collateral Item: <span class="line-field">${document.getElementById('collateralCategory').value}</span></p>
                    <p>Description: <span class="line-field">${collateralDesc}</span></p>
                    <p>Estimated Value: ZMW <span class="line-field">${collateralVal}</span></p>
                    <h3>5. Witness Details</h3>
                    <p>Witness Name: <span class="line-field">${witnessName}</span></p>
                    <p>Witness NRC: <span class="line-field">${witnessNRC}</span></p>
                    <h3>6. Signatures</h3>
                    <p><b>Borrower Signature:</b></p>
                    <div id="borrowerSignaturePad" class="signature-pad-container"></div>
                    <p><b>Witness Signature:</b></p>
                    <div id="witnessSignaturePad" class="signature-pad-container"></div>
                `;
                document.getElementById('agreementContent').innerHTML = agreementHTML;
                // Initialize signature pads
                setTimeout(() => {
                    this.borrowerPad = SignatureManager.createPad(document.getElementById('borrowerSignaturePad'));
                    this.witnessPad = SignatureManager.createPad(document.getElementById('witnessSignaturePad'));
                }, 100);
                document.getElementById('loanAgreementModal').classList.add('active');
            },
            async submitLoanWithAgreement() {
                if(!this.borrowerPad || this.borrowerPad.isEmpty()) {
                    Utils.showToast('Signature required','Please sign as borrower','warning');
                    return;
                }
                if(!this.witnessPad || this.witnessPad.isEmpty()) {
                    Utils.showToast('Signature required','Witness must sign','warning');
                    return;
                }
                const borrowerSig = this.borrowerPad.toDataURL();
                const witnessSig = this.witnessPad.toDataURL();
                const loanData = {
                    amount: parseFloat(document.getElementById('loanAmount').value),
                    duration: parseInt(document.getElementById('loanDuration').value),
                    purpose: document.getElementById('loanPurpose').value,
                    purposeDescription: document.getElementById('purposeDescription').value,
                    collateralCategory: document.getElementById('collateralCategory').value,
                    collateralValue: parseFloat(document.getElementById('collateralValue').value) || 0,
                    collateralDescription: document.getElementById('collateralDescription').value,
                    collateralLocation: document.getElementById('collateralLocation').value,
                    witnessName: document.getElementById('witnessName').value,
                    witnessNRC: document.getElementById('witnessNRC').value,
                    witnessPhone: document.getElementById('witnessPhone').value
                };
                const agreementData = {
                    borrowerSignature: borrowerSig,
                    witnessSignature: witnessSig,
                    timestamp: Date.now()
                };
                Utils.showLoading('Submitting...');
                const result = await FirebaseService.submitLoanApplication(loanData, agreementData);
                Utils.hideLoading();
                if(result.success) {
                    Utils.showToast('Success','Loan application submitted','info');
                    document.getElementById('loanAgreementModal').classList.remove('active');
                    // reset form
                    document.getElementById('loanAmount').value = '';
                    AppState.uploadedCollateral = {};
                    document.querySelectorAll('.upload-preview').forEach(p => p.remove());
                    this.showSection('loans');
                } else {
                    Utils.showToast('Error',result.error,'error');
                }
            },
            renderLoans() {
                const filter = document.getElementById('loanFilterStatus').value;
                let loans = [...AppState.activeLoans, ...AppState.completedLoans];
                if(filter !== 'all') loans = loans.filter(l => l.status === filter);
                const container = document.getElementById('allLoansList');
                container.innerHTML = loans.map(l => `
                    <div class="dashboard-card mb-2" onclick="UIManager.showLoanDetails('${l.id}')" style="cursor:pointer;">
                        <div class="card-header"><span>${Utils.formatCurrency(l.amount)}</span><span class="status-badge-tag status-${l.status}">${l.status}</span></div>
                        <div>${l.purpose}</div>
                    </div>
                `).join('');
            },
            showLoanDetails(loanId) {
                // implementation...
            },
            renderPayments() {
                const activeLoans = AppState.activeLoans.filter(l => l.status==='active');
                const container = document.getElementById('paymentFormContainer');
                if(activeLoans.length===0) {
                    container.innerHTML = '<p class="text-muted">No active loans for payment</p>';
                } else {
                    let options = activeLoans.map(l => `<option value="${l.id}">${Utils.formatCurrency(l.amount)} - ${l.purpose}</option>`).join('');
                    container.innerHTML = `
                        <div class="form-group"><label>Select Loan</label><select id="payLoanSelect" class="form-input">${options}</select></div>
                        <div class="form-group"><label>Amount (Kwacha)</label><input type="number" id="payAmount" class="form-input"></div>
                        <div class="form-group"><label>Method</label><select id="payMethod" class="form-input"><option value="mtn">MTN Money</option><option value="airtel">Airtel Money</option></select></div>
                        <div class="form-group"><label>Reference</label><input type="text" id="payReference" class="form-input"></div>
                        <button class="btn btn-primary" id="submitPaymentBtn">Submit Payment</button>
                    `;
                    document.getElementById('submitPaymentBtn').onclick = () => this.submitPayment();
                }
            },
            async submitPayment() {
                // simplified payment
                Utils.showToast('Payment','Payment simulation (not stored)','info');
            }
        };

        // Global access for inline handlers
        window.UIManager = UIManager;

        // Start
        document.addEventListener('DOMContentLoaded', () => UIManager.init());
    </script>
</body>
</html>
